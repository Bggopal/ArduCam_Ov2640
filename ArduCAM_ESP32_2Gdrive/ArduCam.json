{"files":[{"id":"3af98752-e333-481c-95e3-38de5539c603","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {},\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"d322240d-723e-4cb0-86b2-71d688d9f8ea","name":"Code","type":"server_js","source":"function doPost(e) {\n  var myFoldername \u003d e.parameter.myFoldername;  //取得資料夾名\n  var myFile \u003d e.parameter.myFile;  //取得影像\n  var myFilename \u003d Utilities.formatDate(new Date(), \"GMT+8\", \"yyyyMMddHHmmss\")+\"_\"+e.parameter.myFilename;  //取得影像檔名\n  \n  var contentType \u003d myFile.substring(myFile.indexOf(\":\")+1, myFile.indexOf(\";\"));\n  var data \u003d myFile.substring(myFile.indexOf(\",\")+1);\n  data \u003d Utilities.base64Decode(data);\n  var blob \u003d Utilities.newBlob(data, contentType, myFilename);\n  \n  var folder, folders \u003d DriveApp.getFoldersByName(myFoldername);\n  if (folders.hasNext()) {\n    folder \u003d folders.next();\n  } else {\n    folder \u003d DriveApp.createFolder(myFoldername);\n  }\n  var file \u003d folder.createFile(blob);    \n  file.setDescription(\"Uploaded by \" + myFilename);\n  \n  var imageID \u003d file.getUrl().substring(file.getUrl().indexOf(\"/d/\")+3,file.getUrl().indexOf(\"view\")-1);\n  var imageUrl \u003d \"https://drive.google.com/uc?authuser\u003d0\u0026id\u003d\"+imageID; \n    \n  return  ContentService.createTextOutput(myFoldername+\"/\"+myFilename+\"\\n\"+imageUrl);\n}"}]}